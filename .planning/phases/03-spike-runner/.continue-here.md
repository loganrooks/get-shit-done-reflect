---
phase: 03-spike-runner
task: discuss-phase
total_tasks: TBD
status: in_progress
last_updated: 2026-02-04T10:30:00Z
---

<current_state>
Deep into /gsd:discuss-phase for Phase 3 (Spike Runner). We've been exploring the fundamental design questions about how spikes integrate with the GSD workflow. This is a rich, substantive discussion that has uncovered several architectural decisions that need to be captured.

NOT YET READY to write CONTEXT.md — several open questions remain about fork constraints and integration approach.
</current_state>

<completed_work>

## Areas Discussed

### 1. Spike Structure
- Multiple hypothesis types supported: Binary, Comparative, Exploratory, Open Inquiry
- User asked: "Why do we need to pick one? Can we have different kinds of spikes?" → Yes, type selected at creation
- Open inquiry added as catch-all for questions that don't fit predefined types
- Dedicated folder structure (`.planning/spikes/{name}/`) — Claude decides internal structure
- Multiple concurrent spikes allowed (user manages own focus)
- Success criteria type-dependent (binary needs explicit upfront; exploratory can refine)
- Time limits: Start with estimates, no enforcement, learn from usage
- Spike isolation: Claude's discretion based on risk level
- Artifact retention: Claude's discretion

### 2. Iteration Model
- Partially discussed — round N→N+1 narrowing acknowledged but not deeply explored
- Max depth of 2 rounds per requirements
- Still need to discuss: what triggers narrowing, how partial progress captured

### 3. Decision Output
- Key insight: **Spikes produce FINDINGS, not DECISIONS**
- User pushed back on spike decision-making: "why would it be better for spikes to make decisions?"
- Clarified that findings feed into existing decision-making layers:
  - User decisions → CONTEXT.md
  - Technical recommendations → RESEARCH.md
- Planner receives decisions, doesn't make them
- Researcher synthesizes findings from multiple experiments
- Comparative spikes = one spike with multiple experiments (OCR library example: test 3 libraries, researcher synthesizes)
- User asked about multiple spikes for one decision → poor spike design; should be one spike with multiple experiments

### 4. Workflow UX / Integration
- **This consumed most of our discussion time**

#### Should spikes be linked to phases?
- User asked: "Under what circumstances would we run a spike not associated with a phase?"
- Conclusion: Spikes should probably reference originating phase/work
- But could link to multiple phases depending on relevance

#### Where does spike identification happen?
- Discussed two models:
  - **Model A: Inside research** — Researcher triggers spikes when hitting uncertainty
  - **Model B: Before research** — discuss-phase identifies uncertainties, spikes run first
  - **Both available** — discuss-phase catches known uncertainties, researcher catches discovered ones
- User leaning toward "both available"

#### Agent vs Skill distinction
- User asked: "should spike design be a skill? Or just an agent?"
- Explored GSD structure: Commands (skills) = user entry points; Agents = workers spawned by commands
- Conclusion: `/gsd:spike` = skill (command), `gsd-spike-designer`/`gsd-spike-runner` = agents

#### Debugging as spike parallel
- Deep dive into gsd-debugger revealed it's essentially an "investigation spike"
- Both use: scientific method, persistent state files, hypothesis testing
- Key difference: Debug "build" is trivial (add logging), Spike "build" is substantial (write prototype)

#### The Build phase distinction (USER EMPHASIS)
- User specifically highlighted: "Where does the code and set up of the experiment environment take place?"
- Build/Setup is actual coding work, not trivial
- This is why spikes need more structure than debugging
- Led to proposed three-phase model: Design → Build → Run+Decide

#### Provenance/linking question
- Should spikes track what triggered them?
- Options: Required link, Optional context, No tracking
- User asked for clarification — wants to understand workflow fit first
- NOT RESOLVED

### 5. GSD Decision-Making Model (Deep Dive)
- User asked: "Where are architectural decisions made? Is there a distinct phase?"
- Discovered: NO explicit architecture decision phase
- Decisions currently embedded in:
  - CONTEXT.md (user preferences from discuss-phase)
  - RESEARCH.md (technical recommendations — "prescriptive: Use X not Consider X or Y")
- Planner doesn't decide, implements
- Plan-checker verifies goal achievement, NOT decision alignment (potential gap, though recent upstream added "Context Compliance" dimension)

### 6. Decision Dependencies
- User asked: "Are there decisions that depend on the answer to other design questions?"
- Yes — decision graphs can be complex (e.g., "Which auth library?" depends on "Which framework?" depends on "SSR vs SPA?")
- Implies spike dependencies might be needed
- Traditional software uses ADRs (Architecture Decision Records) for this
- NOT FULLY RESOLVED — how to handle spike/decision dependencies

### 7. Roadmap-Level Integration
- User asked: "What about initial roadmap creation? Is there a place for spikes there?"
- Current new-project flow: Questioning → Research → Requirements → Roadmap
- No spike integration at roadmap level currently
- Project-level uncertainties ("Is this architecture feasible?") might need pre-roadmap spikes
- Would require modifying new-project.md → conflicts with fork constraint

### 8. Fork Constraint Analysis
- Examined actual git history — 40+ commits/month to workflow files
- Files we'd modify (discuss-phase, plan-phase, researcher, planner) are actively developed
- Recent example: `3257139 fix(plan-phase): pass CONTEXT.md to all downstream agents` touched FOUR files we'd want to modify
- Constraint was reasonable given data
- BUT: User questioned if constraint was set before understanding full scope

## Key Insights Discovered

1. **Where decisions are made in GSD:**
   - CONTEXT.md = user decisions (locked preferences)
   - RESEARCH.md = technical recommendations (prescriptive: "Use X" not "Consider X or Y")
   - PLAN.md = implementation (planner doesn't decide, implements)
   - Plan-checker does NOT verify alignment with decisions (potential gap)

2. **Spike integration points:**
   - Roadmap level (project-wide uncertainty)
   - discuss-phase (known uncertainties)
   - research (discovered uncertainties)
   - planning (blocking uncertainties)
   - execution (debugging territory)

3. **Agent structure proposed:**
   - `/gsd:spike` command (orchestrator)
   - `gsd-spike-designer` or interactive design phase
   - `gsd-spike-runner` agent (build + run + produce decision record)
   - Parallels to gsd-debugger pattern (scientific method, persistent state file)

4. **Phases of a spike:**
   - Design (cognitive) → hypothesis, criteria, experiment plan
   - Build/Setup (coding) → actual implementation work
   - Run (execution) → gather evidence
   - Decide (analysis) → produce decision record

5. **gsd-executor cannot be directly reused** — too tightly coupled to phase/plan structure. But patterns are valuable (atomic commits, deviation handling, checkpoints, state persistence).

</completed_work>

<remaining_work>

## Open Questions NOT Yet Resolved

### Fork Constraint Decision (CRITICAL)
We hit the fork maintenance constraint:
> "all changes must be additive (new files only, no upstream edits)"

Data shows GSD is actively developed (40+ commits/month to workflow files). Modifying discuss-phase, plan-phase, researcher would cause merge conflicts.

**Options presented but NOT decided:**
1. Keep constraint → spikes are standalone `/gsd:spike`, manual invocation only
2. Relax constraint → modify upstream files, accept maintenance burden
3. Propose upstream → submit PR for uncertainty hooks (longer timeline)
4. Wrapper commands → `/gsd-reflect:discuss-phase` etc. (middle ground)

User was considering this when they paused.

### Integration Model
Depends on fork constraint decision:
- If additive only: Spikes are escape hatch, user invokes manually
- If modifications allowed: Spikes integrate into discuss-phase, plan-phase

### Spike Dependencies
Discussed but not fully resolved:
- Can spikes depend on other spikes?
- How to handle decision chains? (e.g., Spike B can't be designed until Spike A's decision is made)
- Is this similar to plan dependencies? Could use `depends_on` pattern
- What about decisions that depend on results from MULTIPLE independent spikes?

### Roadmap-Level Spikes
Should spikes exist at project initialization (new-project/new-milestone)?
- Currently no spike integration at roadmap level
- Would require modifying new-project.md (conflicts with constraint)
- User specifically asked about this integration point

### Spike Provenance
Should spikes track what phase/work triggered them?
- Required link vs Optional context vs No tracking
- User wanted to understand workflow fit before deciding
- NOT RESOLVED

### Plan-Checker Gap
Discovered that plan-checker doesn't verify plans align with CONTEXT.md/RESEARCH.md decisions
- Recent upstream added "Context Compliance" dimension (commit 3257139)
- But might still be a gap for spike-related decisions
- Should spike decisions be verified in plans?

## Still Need to Discuss
- Specific CONTEXT.md sections for Phase 3
- Detailed spike file format (DESIGN.md, DECISION.md structure)
- KB storage integration for spike decisions
- Autonomy levels for spike workflow
- How findings flow from spike → RESEARCH.md (or CONTEXT.md)
- Spike state file format (parallel to debug file protocol)
- Checkpoint behavior for spikes (when to pause for user input)

</remaining_work>

<decisions_made>

## Confirmed Decisions
1. **Spike types:** Binary, Comparative, Exploratory, Open Inquiry (flexible)
2. **Hypothesis specificity:** Type-dependent (Claude's discretion for open inquiry)
3. **Workspace location:** `.planning/spikes/{name}/` dedicated folder
4. **Concurrency:** Multiple spikes allowed simultaneously
5. **Time limits:** Estimates only, no enforcement initially
6. **Success criteria:** Type-dependent strictness
7. **Spikes produce FINDINGS, not DECISIONS** — existing layers (CONTEXT.md, RESEARCH.md) make decisions
8. **One spike = one question** — comparative questions are one spike with multiple experiments

## Deferred to Claude's Discretion
- Open inquiry spike structure
- Experiment design depth by type
- Artifact retention after completion
- Spike isolation approach

</decisions_made>

<blockers>

### Fork Constraint vs Integration Depth
The fundamental tension: good spike integration requires modifying upstream files, but constraint says additive-only.

User was weighing:
- Is the maintenance burden actually that bad?
- Should we relax the constraint?
- Or accept manual spike invocation?

This needs to be resolved before CONTEXT.md can be written.

</blockers>

<context>
## Mental State / Approach

This discussion went DEEP. We started with the discuss-phase workflow asking about gray areas, but quickly surfaced fundamental architectural questions:

1. How do spikes fit into GSD's decision-making model?
2. Where are decisions actually made? (discovered it's CONTEXT.md + RESEARCH.md, not planning)
3. Can we integrate spikes without modifying upstream? (discovered: not really, not well)
4. Is the fork constraint reasonable? (discovered: yes, active development, but maybe worth relaxing)

The conversation revealed that the "additive only" constraint was made before understanding the full scope of spike integration. The user is open to revising it if the data supports it.

## What the User Was Thinking

User was evaluating whether to:
- Accept the constraint and build standalone spikes
- OR relax the constraint and build integrated spikes with maintenance burden

They asked to pause right at this decision point.

## Key User Questions That Shaped Discussion

1. "Why do we need to pick one [hypothesis type]? Can we have different kinds of spikes?"
2. "Should we also have a category that is more flexible for inquiries that don't quite fit?"
3. "Where in this workflow does the code and the set up of the experiment environment take place?"
4. "Do we make decisions then? Or do we just report on the results of the experiments?"
5. "What if we are running several spikes in parallel... what if a decision depends on the results from multiple spikes?"
6. "Where are architectural decisions made? Is there a distinct phase?"
7. "Should spikes be tied to specific design questions?"
8. "What about the initial roadmap creation... is there a place for spikes there?"
9. "Will fork maintenance be that difficult? What kind of changes have been made to the codebase over the past two weeks?"
10. "We can modify the constraint if it is unreasonable... this is clearly a result of not thinking through initially"

These questions drove the discussion deeper than typical discuss-phase — into GSD architecture itself.

## Files Read This Session
- /Users/rookslog/.claude/get-shit-done/workflows/discuss-phase.md
- /Users/rookslog/.claude/get-shit-done/templates/context.md
- /Users/rookslog/.claude/commands/gsd/plan-phase.md
- /Users/rookslog/.claude/commands/gsd/research-phase.md
- /Users/rookslog/.claude/commands/gsd/discuss-phase.md
- /Users/rookslog/.claude/commands/gsd/new-project.md
- /Users/rookslog/.claude/commands/gsd/new-milestone.md
- /Users/rookslog/.claude/commands/gsd/debug.md
- /Users/rookslog/.claude/agents/gsd-debugger.md
- /Users/rookslog/.claude/agents/gsd-executor.md
- /Users/rookslog/.claude/commands/gsd/execute-phase.md
- /Users/rookslog/.claude/agents/gsd-plan-checker.md
- /Users/rookslog/.claude/agents/gsd-planner.md (partial)
- .planning/STATE.md
- .planning/ROADMAP.md
- .planning/PROJECT.md
- .planning/research/* (multiple files for fork constraint research)

</context>

<next_action>
## When Resuming

### Open Questions to Resolve (in priority order)

1. **Fork constraint decision** (BLOCKING)
   - Keep constraint → standalone `/gsd:spike`, manual invocation
   - Relax constraint → integrated spikes, maintenance burden
   - Wrapper commands → middle ground (new reflect commands)
   - Propose upstream → long-term (not Phase 3 scope)

2. **Spike provenance**
   - Should spikes require linking to phase/task that triggered them?
   - Or standalone allowed?

3. **Spike dependencies**
   - Can Spike B depend on Spike A's decision?
   - How to handle decision chains?

4. **Integration model** (depends on #1)
   - If standalone: Just `/gsd:spike` command, user invokes when needed
   - If integrated: Where exactly? discuss-phase? research? both?

5. **Findings → Decisions flow**
   - How do spike findings feed into RESEARCH.md or CONTEXT.md?
   - Who synthesizes multiple experiments? Researcher? New agent?

6. **Iteration model details**
   - What triggers narrowing from round N to N+1?
   - How is partial progress captured?

### After Questions Resolved

1. Complete any remaining gray area exploration
2. Write 03-CONTEXT.md with all decisions
3. Offer next steps (plan-phase)

## Questions to Ask User on Resume

1. "Do you want to keep the 'additive only' fork constraint, relax it, or try wrapper commands?"

2. "Should spikes always be linked to the phase/work that triggered them, or can they be standalone?"

3. "For spike dependencies — should we support `depends_on` like plans, or keep spikes independent?"

4. "Should spike findings write directly to RESEARCH.md, or stay in separate DECISION.md files that researcher reads?"
</next_action>

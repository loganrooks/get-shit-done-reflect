---
phase: 22-agent-boilerplate-extraction
plan: 03
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - .claude/agents/gsd-debugger.md
  - .claude/agents/gsd-phase-researcher.md
  - .claude/agents/gsd-project-researcher.md
autonomous: true

must_haves:
  truths:
    - "gsd-debugger.md loads agent-protocol.md via <required_reading> and no longer contains inline git safety or commit format rules"
    - "gsd-phase-researcher.md loads agent-protocol.md via <required_reading> and no longer contains inline tool_strategy, source_hierarchy, or verification_protocol sections"
    - "gsd-project-researcher.md loads agent-protocol.md via <required_reading> and no longer contains inline tool_strategy, confidence levels, or verification_protocol sections"
    - "All three agents retain their full identity sections (role, philosophy, domain methodology, execution steps) above the required_reading tag"
  artifacts:
    - path: ".claude/agents/gsd-debugger.md"
      provides: "Lean debugger spec referencing shared protocol"
      contains: "<required_reading>"
    - path: ".claude/agents/gsd-phase-researcher.md"
      provides: "Lean phase researcher spec referencing shared protocol"
      contains: "<required_reading>"
    - path: ".claude/agents/gsd-project-researcher.md"
      provides: "Lean project researcher spec referencing shared protocol"
      contains: "<required_reading>"
  key_links:
    - from: ".claude/agents/gsd-debugger.md"
      to: ".claude/get-shit-done/references/agent-protocol.md"
      via: "<required_reading> tag"
      pattern: "required_reading"
    - from: ".claude/agents/gsd-phase-researcher.md"
      to: ".claude/get-shit-done/references/agent-protocol.md"
      via: "<required_reading> tag"
      pattern: "required_reading"
    - from: ".claude/agents/gsd-project-researcher.md"
      to: ".claude/get-shit-done/references/agent-protocol.md"
      via: "<required_reading> tag"
      pattern: "required_reading"
---

<objective>
Extract shared operational content from gsd-debugger.md, gsd-phase-researcher.md, and gsd-project-researcher.md, replacing inline duplication with `<required_reading>` references.

Purpose: The debugger has significant git safety and commit format duplication. The two researcher agents have the LARGEST single duplication in the codebase (~90 lines of near-identical tool_strategy, source_hierarchy, and verification_protocol content). Extracting these yields the biggest per-agent line reduction.

Output: Three leaner agent specs, each with `<required_reading>` reference to agent-protocol.md
</objective>

<execution_context>
@/Users/rookslog/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rookslog/.claude/get-shit-done/templates/summary-standard.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-agent-boilerplate-extraction/22-CONTEXT.md
@.planning/phases/22-agent-boilerplate-extraction/22-EXTRACTION-REGISTRY.md

Protocol reference:
@.claude/get-shit-done/references/agent-protocol.md

Agents to edit:
@.claude/agents/gsd-debugger.md
@.claude/agents/gsd-phase-researcher.md
@.claude/agents/gsd-project-researcher.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract shared content from gsd-debugger.md</name>
  <files>.claude/agents/gsd-debugger.md</files>
  <action>
Edit `gsd-debugger.md` to remove sections now covered by the shared protocol, and add a `<required_reading>` reference.

**IMPORTANT:** The debugger is the largest agent at 1,198 lines. Most of its content is domain-specific (hypothesis testing, scientific method, debug session management). The extraction targets are concentrated in the git/commit sections.

**REMOVE these sections/content (now in protocol):**

1. **Git safety rules** — Any "NEVER git add -A or git add ." rules. Search for these near L991. These are now in protocol Section 1.

2. **Commit format/conventions** — The abbreviated commit format section near L991-998. The gsd-tools.js commit pattern. These are now in protocol Sections 3-4.

3. **commit_docs convention** — Any inline mention of commit_docs behavior. Now in protocol Section 5.

4. **gsd-tools.js init pattern** — The general init pattern (if present). The specific `init` subcommand and extracted fields stay as part of execution_flow.

**KEEP these sections (identity/domain-specific — this is the bulk of the agent):**
- `<role>` — debugger identity
- `<philosophy>` — debugger identity (User = Reporter, Meta-Debugging, Foundation Principles, Cognitive Biases, Systematic Investigation, When to Restart)
- `<debug_modes>` — domain methodology
- `<session_management>` — domain methodology
- `<hypothesis_testing>` — domain methodology (scientific method)
- `<checkpoint_handling>` — debugger-specific checkpoint behavior
- `<evidence_gathering>` — domain methodology
- `<fix_and_verify>` — domain methodology
- `<execution_flow>` — debugger-specific steps
- `<structured_returns>` — debugger-specific return formats
- `<success_criteria>` — debugger-specific criteria

**ADD `<required_reading>` tag** after all domain methodology sections and before `<execution_flow>`:

```markdown
<required_reading>
@./.claude/get-shit-done/references/agent-protocol.md
</required_reading>
```

**Expected result:** Debugger spec shrinks modestly (most content is domain-specific), retains all identity and hypothesis testing methodology, gains protocol reference for git/commit conventions.
  </action>
  <verify>
1. `grep -c "required_reading" .claude/agents/gsd-debugger.md` returns 2
2. `grep -c "hypothesis_testing" .claude/agents/gsd-debugger.md` returns at least 1 (domain methodology retained)
3. `grep -c "scientific" .claude/agents/gsd-debugger.md` returns at least 1 (methodology retained)
4. `grep -c "philosophy" .claude/agents/gsd-debugger.md` returns at least 1 (identity retained)
  </verify>
  <done>gsd-debugger.md references shared protocol, git/commit duplication removed, all hypothesis testing and scientific method methodology retained above the protocol reference.</done>
</task>

<task type="auto">
  <name>Task 2: Extract shared content from both researcher agents</name>
  <files>.claude/agents/gsd-phase-researcher.md, .claude/agents/gsd-project-researcher.md</files>
  <action>
Edit BOTH researcher agents to remove the ~90 lines of near-identical tool_strategy, source_hierarchy, and verification_protocol content, replacing with `<required_reading>` references.

**gsd-phase-researcher.md — REMOVE:**

1. **`<tool_strategy>` section** (L84-130, ~47 lines) — Tool priority table, Context7 flow, WebSearch tips, Brave Search API, verification protocol within this section. ALL of this is now in protocol Sections 8-10. REMOVE the entire `<tool_strategy>` section.

2. **`<source_hierarchy>` section** (L132-142, ~11 lines) — Confidence level table and source priority chain. Now in protocol Section 9. REMOVE the entire section.

3. **`<verification_protocol>` section** (L144-174, ~31 lines) — Known pitfalls and pre-submission checklist. Now in protocol Section 10. REMOVE the entire section.

4. **gsd-tools.js commit pattern** — In Step 6 of execution_flow. Simplify to reference protocol. Keep the specific commit message and file path since those are researcher-specific.

5. **commit_docs convention** — The "commit_docs controls git only" note. Now in protocol Section 5.

**gsd-phase-researcher.md — KEEP:**
- `<role>` — researcher identity
- `<upstream_input>` — phase researcher specific (CONTEXT.md handling)
- `<downstream_consumer>` — phase researcher specific (planner expectations)
- `<philosophy>` — researcher identity (Claude's Training as Hypothesis, Honest Reporting, Investigation Not Confirmation)
- `<output_format>` — phase researcher specific (RESEARCH.md structure)
- `<execution_flow>` — phase researcher specific steps (minus tool/commit conventions)
- `<structured_returns>` — phase researcher specific return formats
- `<success_criteria>` — phase researcher specific

**ADD `<required_reading>` tag** after `<philosophy>` and before `<output_format>`:

```markdown
<required_reading>
@./.claude/get-shit-done/references/agent-protocol.md
</required_reading>
```

---

**gsd-project-researcher.md — REMOVE:**

1. **`<tool_strategy>` section** (L63-134, ~72 lines) — Tool priority order, Context7 usage, WebFetch, WebSearch, Brave API, verification protocol, confidence levels. ALL now in protocol Sections 8-10. REMOVE the entire `<tool_strategy>` section.

2. **`<verification_protocol>` section** (L136-166, ~31 lines) — Research pitfalls and pre-submission checklist. Now in protocol Section 10. REMOVE the entire section.

**gsd-project-researcher.md — KEEP:**
- `<role>` — project researcher identity (different from phase researcher)
- `<philosophy>` — shared philosophy theme but unique framing
- `<research_modes>` — project researcher specific (Ecosystem/Feasibility/Comparison)
- `<output_formats>` — project researcher specific (SUMMARY/STACK/FEATURES/ARCHITECTURE/PITFALLS/COMPARISON/FEASIBILITY)
- `<execution_flow>` — project researcher specific steps
- `<structured_returns>` — project researcher specific return formats
- `<success_criteria>` — project researcher specific

**ADD `<required_reading>` tag** after `<philosophy>` and before `<research_modes>`:

```markdown
<required_reading>
@./.claude/get-shit-done/references/agent-protocol.md
</required_reading>
```

**Expected result:** Both researchers shrink significantly (~90+ lines removed each). This is the single largest extraction in the phase. Both retain their unique output formats and execution flows.
  </action>
  <verify>
1. `grep -c "required_reading" .claude/agents/gsd-phase-researcher.md` returns 2
2. `grep -c "required_reading" .claude/agents/gsd-project-researcher.md` returns 2
3. `grep -c "tool_strategy" .claude/agents/gsd-phase-researcher.md` returns 0 (extracted)
4. `grep -c "tool_strategy" .claude/agents/gsd-project-researcher.md` returns 0 (extracted)
5. `grep -c "source_hierarchy" .claude/agents/gsd-phase-researcher.md` returns 0 (extracted)
6. `grep -c "verification_protocol" .claude/agents/gsd-phase-researcher.md` returns 0 (extracted)
7. `grep -c "verification_protocol" .claude/agents/gsd-project-researcher.md` returns 0 (extracted)
8. `grep -c "output_format" .claude/agents/gsd-phase-researcher.md` returns at least 1 (domain content retained)
9. `grep -c "research_modes" .claude/agents/gsd-project-researcher.md` returns at least 1 (domain content retained)
  </verify>
  <done>Both researcher agents reference shared protocol, ~90+ lines of duplicated tool_strategy/source_hierarchy/verification_protocol removed from each, unique output formats and execution flows retained.</done>
</task>

</tasks>

<verification>
- [ ] All three agents contain `<required_reading>` referencing agent-protocol.md
- [ ] Debugger retains hypothesis testing, scientific method, debug session management
- [ ] Phase researcher no longer has inline tool_strategy, source_hierarchy, verification_protocol
- [ ] Project researcher no longer has inline tool_strategy, verification_protocol
- [ ] Both researchers retain their unique output formats and execution flows
- [ ] Agent-specific content appears ABOVE the required_reading tag in all three specs
</verification>

<success_criteria>
gsd-debugger.md, gsd-phase-researcher.md, and gsd-project-researcher.md are leaner, reference the shared protocol, and retain all domain-specific methodology. The researchers have the largest line reduction (~90+ lines each).
</success_criteria>

<output>
After completion, create `.planning/phases/22-agent-boilerplate-extraction/22-03-SUMMARY.md`
</output>

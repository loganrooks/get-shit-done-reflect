---
phase: pr4-review-fixes
task: 0
total_tasks: 6
status: in_progress
last_updated: 2026-02-16T07:09:21.264Z
---

<current_state>
PR #4 (v1.14.0: Multi-Runtime Interop) reviewed with 3 parallel agents. Review posted to GitHub.
Decision: fix 6 critical bugs before merging, defer test quality issues to v1.15.
On branch `sync/v1.13-upstream`. PR is OPEN, CI green.
</current_state>

<completed_work>

- PR #4 code review completed with 3 parallel agents (installer, tests, workflows)
- Review comment posted to https://github.com/loganrooks/get-shit-done-reflect/pull/4
- Identified 10 CRITICAL, 15 WARNING findings
- Decision: fix C1-C6 before merge, defer C7-C10 (test quality) + all warnings to v1.15
</completed_work>

<remaining_work>

## Fix before merging PR #4:

### Installer fixes (bin/install.js):
- Task 1: C1 — `migrateKB()` add collision check for `.migration-backup` (line 294). Check if backup exists; append timestamp or skip with warning.
- Task 2: C2 — `migrateKB()` handle dangling symlinks with `fs.lstatSync()` (lines 264-308). Use lstatSync to detect, unlinkSync to remove before creating new symlink.
- Task 3: C3 — `convertClaudeToCodexSkill()` fix `@` file reference regex for absolute paths in global installs (lines 807-809). Make regex dynamic based on actual `pathPrefix`, or match before path replacement.

### Workflow fixes:
- Task 4: C4 — `get-shit-done/workflows/collect-signals.md` add `<capability_check name="agent_spawning">` around Task() at line 106. Copy pattern from execute-phase.md.
- Task 5: C5 — `get-shit-done/workflows/reflect.md` add `<capability_check>` around Task() at line 187.
- Task 6: C6 — `get-shit-done/workflows/run-spike.md` add `<capability_check>` around agent spawn at ~line 160.

### After fixes:
- Run tests (`npm test`)
- Commit fixes
- Merge PR #4 to main
- Tag v1.14.0
- Publish to npm
- Then `/gsd:new-milestone` for v1.15

## Deferred to v1.15:
- C7-C10: Test quality (self-fulfilling tests, scaffolding tests inflating count from 159)
- W1-W15: Various warnings (see PR #4 review comment for full list)
- v1.15 candidate exists at `.planning/milestones/v1.15-CANDIDATE.md` (Token Efficiency & MCP Infrastructure)
</remaining_work>

<decisions_made>

- Fix C1-C6 (installer + workflow criticals) before merging PR #4
- Defer C7-C10 (test quality) and all warnings to v1.15
- The pattern for `<capability_check>` exists in execute-phase.md (lines 54-88) and plan-phase.md (lines 56-68) — copy from there
- KB is safe during updates (confirmed during session)
- npm update to 1.13.0 was aborted — need to merge PR #4 and publish 1.14.0 first
</decisions_made>

<blockers>
None — all fixes are straightforward with existing patterns to follow.
</blockers>

<context>
Branch: sync/v1.13-upstream (has all v1.14 work)
PR #4: open against main, CI green, review posted
npm: currently at 1.13.0, needs 1.14.0 published after merge
The review found real bugs in edge cases:
- KB migration crash paths (dangling symlinks, backup collisions)
- Codex global install has broken @ file references (60+ affected)
- 3 workflows missing capability_check blocks (would break on Codex CLI)
</context>

<next_action>
1. `/clear` for fresh context
2. `/gsd:resume-work` to reload state
3. Fix C1-C3 in bin/install.js
4. Fix C4-C6 in workflow files
5. Run tests, commit, merge PR #4
</next_action>

---
phase: 29-test-fixes-installer-deploy
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/get-shit-done/bin/gsd-tools.js
autonomous: true

must_haves:
  truths:
    - "Repo-local .claude/get-shit-done/bin/gsd-tools.js is byte-identical to source get-shit-done/bin/gsd-tools.js"
    - "Global ~/.claude/get-shit-done/bin/gsd-tools.js is byte-identical to source get-shit-done/bin/gsd-tools.js"
    - "No tracked files in .claude/ are modified after local install"
  artifacts:
    - path: ".claude/get-shit-done/bin/gsd-tools.js"
      provides: "Deployed gsd-tools binary (repo-local)"
      min_lines: 5400
    - path: "~/.claude/get-shit-done/bin/gsd-tools.js"
      provides: "Deployed gsd-tools binary (global)"
      min_lines: 5400
  key_links:
    - from: "bin/install.js"
      to: "get-shit-done/bin/gsd-tools.js"
      via: "copyWithPathReplacement copies .js files verbatim"
      pattern: "copyFileSync"
---

<objective>
Redeploy the installer to close the 875-line gap between source and deployed gsd-tools.js binaries (both repo-local and global), and verify deployed copies match source.

Purpose: Ensure the installed binary includes all commands added since the last deployment (manifest operations, backlog commands, config migration, etc.) so users running `/gsd:` commands get current behavior.
Output: Three identical copies of gsd-tools.js -- source, repo-local deployed, and global deployed.
</objective>

<execution_context>
@/Users/rookslog/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rookslog/.claude/get-shit-done/templates/summary-standard.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-test-fixes-installer-deploy/29-RESEARCH.md

@bin/install.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run installer for local and global targets</name>
  <files>.claude/get-shit-done/bin/gsd-tools.js</files>
  <action>
  Run the installer for both targets:

  ```bash
  # Deploy to repo-local .claude/ directory
  node bin/install.js --claude --local

  # Deploy to global ~/.claude/ directory
  node bin/install.js --claude --global
  ```

  **Important anti-pattern awareness:** The local install removes `.claude/get-shit-done/` before copying from source. This will overwrite tracked files in `.claude/get-shit-done/` (references/agent-protocol.md, workflows/collect-signals.md, workflows/reflect.md, workflows/run-spike.md). These should be identical to their source equivalents, but verify with `git diff .claude/` after install.

  The installer does NOT touch `.claude/agents/` or `.claude/commands/gsd/`, so the 3 restored agent specs and 2 restored commands from Phase 28 are safe.

  After both installs complete, verify no unexpected changes to tracked files:
  ```bash
  git diff .claude/
  git status .claude/
  ```

  If `git diff` shows changes in tracked `.claude/get-shit-done/` files, those changes represent the source->deployed sync (expected). Stage them for commit.
  If `git diff` shows changes in `.claude/agents/` or `.claude/commands/gsd/`, something is wrong -- investigate.
  </action>
  <verify>
  Both installer commands exit 0. `git diff .claude/` shows only expected changes (gsd-tools.js updated, possibly gsd-tools.test.js updated, workflow/reference files potentially refreshed from source).
  </verify>
  <done>Installer has run successfully for both local and global targets.</done>
</task>

<task type="auto">
  <name>Task 2: Verify deployed binaries match source</name>
  <files>.claude/get-shit-done/bin/gsd-tools.js</files>
  <action>
  Verify all three copies of gsd-tools.js are identical using hash comparison:

  ```bash
  shasum get-shit-done/bin/gsd-tools.js \
        .claude/get-shit-done/bin/gsd-tools.js \
        ~/.claude/get-shit-done/bin/gsd-tools.js
  ```

  All three SHA hashes MUST be identical. Also verify line counts match:

  ```bash
  wc -l get-shit-done/bin/gsd-tools.js \
       .claude/get-shit-done/bin/gsd-tools.js \
       ~/.claude/get-shit-done/bin/gsd-tools.js
  ```

  All three should show the same line count (currently 5472, but may be slightly different if Plan 01 or other work has modified the source -- the exact count doesn't matter, only that all three match).

  Finally, verify file permissions are preserved:
  ```bash
  ls -la get-shit-done/bin/gsd-tools.js .claude/get-shit-done/bin/gsd-tools.js ~/.claude/get-shit-done/bin/gsd-tools.js
  ```

  Stage any changes in `.claude/` for commit.
  </action>
  <verify>
  ```bash
  shasum get-shit-done/bin/gsd-tools.js .claude/get-shit-done/bin/gsd-tools.js ~/.claude/get-shit-done/bin/gsd-tools.js
  ```
  Returns 3 identical hashes.
  </verify>
  <done>Source, repo-local deployed, and global deployed gsd-tools.js are byte-identical. The 875-line gap is closed.</done>
</task>

</tasks>

<verification>
```bash
# Verify all three copies match
shasum get-shit-done/bin/gsd-tools.js \
      .claude/get-shit-done/bin/gsd-tools.js \
      ~/.claude/get-shit-done/bin/gsd-tools.js

# Verify no unexpected tracked file changes
git diff --stat .claude/
```
</verification>

<success_criteria>
1. `node bin/install.js --claude --local` and `--global` both exit 0
2. SHA hash of source, repo-local, and global gsd-tools.js are identical
3. Line count of all three copies match
4. No unexpected changes to tracked files in .claude/agents/ or .claude/commands/gsd/
</success_criteria>

<output>
After completion, create `.planning/phases/29-test-fixes-installer-deploy/29-02-SUMMARY.md`
</output>

---
phase: 18-capability-matrix-installer-corrections
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/references/capability-matrix.md
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "capability-matrix.md Quick Reference table shows Gemini mcp_servers=Y with annotation"
    - "capability-matrix.md Quick Reference table shows Codex mcp_servers=Y with annotation"
    - "capability-matrix.md Quick Reference table shows Gemini tool_permissions=Y with annotation"
    - "capability-matrix.md Quick Reference table shows Gemini task_tool=Y with experimental/sequential annotation"
    - "Capability Details prose sections match the Quick Reference table values"
    - "Degraded Behavior Summary tables for Codex CLI and Gemini CLI reflect corrected capabilities"
  artifacts:
    - path: "get-shit-done/references/capability-matrix.md"
      provides: "Corrected runtime capability matrix"
      contains: "Y [1]"
  key_links:
    - from: "Quick Reference table"
      to: "Capability Details sections"
      via: "consistent Y/N values"
      pattern: "Available in:.*Gemini CLI"
    - from: "Quick Reference table"
      to: "Degraded Behavior Summary"
      via: "consistent feature status"
      pattern: "MCP servers.*Y"
---

<objective>
Update the capability matrix reference document to reflect corrected runtime capabilities for Gemini CLI and Codex CLI. Four cells are stale: Codex mcp_servers, Gemini mcp_servers, Gemini tool_permissions, and Gemini task_tool annotation.

Purpose: The capability matrix is the single source of truth that LLM orchestrators read at runtime to determine feature availability. Stale values cause incorrect degradation behavior (stripping content that should be preserved).

Output: Corrected `get-shit-done/references/capability-matrix.md` with all sections internally consistent.
</objective>

<execution_context>
@/Users/rookslog/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rookslog/.claude/get-shit-done/templates/summary-standard.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@get-shit-done/references/capability-matrix.md
@.planning/phases/18-capability-matrix-installer-corrections/18-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Quick Reference table with corrected cells and annotations</name>
  <files>get-shit-done/references/capability-matrix.md</files>
  <action>
Update the Quick Reference table (4 cells) and add footnotes:

1. Change `task_tool` Gemini CLI cell from `Y` to `Y [1]`
2. Change `tool_permissions` Gemini CLI cell from `N` to `Y [2]`
3. Change `mcp_servers` Gemini CLI cell from `N` to `Y [3]`
4. Change `mcp_servers` Codex CLI cell from `N` to `Y [4]`

Add footnotes below the table:
```
[1] Experimental, sequential only. Parallel subagent execution not yet available.
[2] Via tools.core (allowlist), tools.exclude (denylist), and per-sub-agent restrictions.
[3] STDIO, SSE, and Streamable HTTP transports. OAuth support.
[4] STDIO and Streamable HTTP transports. OAuth support.
```

IMPORTANT: The `Impact When Missing` column for `mcp_servers` still applies to runtimes where it IS missing (none, after this fix -- all 4 runtimes now support MCP). Consider updating the column value or leaving it as documentation of what WOULD happen if missing.
  </action>
  <verify>Read the file and confirm: (a) all 4 cells updated, (b) footnotes present and correctly numbered, (c) table alignment is valid markdown</verify>
  <done>Quick Reference table shows Y[1] for Gemini task_tool, Y[2] for Gemini tool_permissions, Y[3] for Gemini mcp_servers, Y[4] for Codex mcp_servers, with matching footnotes below</done>
</task>

<task type="auto">
  <name>Task 2: Update Capability Details prose and Degraded Behavior Summary sections</name>
  <files>get-shit-done/references/capability-matrix.md</files>
  <action>
Update ALL prose sections to be consistent with the corrected Quick Reference table. This file has multiple places where capability values are stated -- ALL must be updated:

**tool_permissions section (Capability Details):**
- Change "Available in: Claude Code (allowed-tools list), OpenCode (permission map in YAML)" to include Gemini CLI
- Update to: "Available in: Claude Code (allowed-tools list), OpenCode (permission map in YAML), Gemini CLI (tools.core allowlist, tools.exclude denylist)"
- Change "Missing in: Gemini CLI, Codex CLI" to "Missing in: Codex CLI"
- Update the "Degraded behavior when missing" prose to reflect that it now only applies to Codex CLI
- Update the "How orchestrators adapt" prose -- the installer now preserves tool permission frontmatter for Gemini (no longer strips it)

**mcp_servers section (Capability Details):**
- Change "Available in: Claude Code, OpenCode" to "Available in: Claude Code, OpenCode, Gemini CLI, Codex CLI"
- Change "Missing in: Gemini CLI, Codex CLI" to remove it entirely or state "Available in all supported runtimes"
- Update "Degraded behavior when missing" to note this is now informational (all runtimes support MCP)
- Update "How orchestrators adapt" -- the installer no longer strips MCP tools for any runtime

**task_tool section (Capability Details):**
- Add annotation that Gemini CLI's task_tool support is experimental and sequential-only (parallel subagent execution not yet available)
- Keep the Y value but note the limitation

**Degraded Behavior Summary - Codex CLI table:**
- Change MCP servers row from `N | MCP features skipped` to `Y | Full MCP support via STDIO and Streamable HTTP`
- Update the summary paragraph below the table to reflect reduced constraint set

**Degraded Behavior Summary - Gemini CLI table:**
- Remove tool_permissions row (no longer missing) OR change to `Y | ...`
- Remove MCP servers row (no longer missing) OR change to `Y | ...`
- If both rows removed, update the summary paragraph. Gemini CLI now only has the task_tool experimental limitation as a caveat (not a missing feature, but a limited one).
- Update summary paragraph to reflect that Gemini CLI is near-full capability (similar to OpenCode)

CRITICAL: After ALL changes, grep the file for any remaining instances of text that contradicts the new values. Specifically search for:
- "Missing in: Gemini CLI" (should not appear for mcp_servers or tool_permissions)
- "Missing in:.*Codex CLI" in the mcp_servers section (should not appear)
- "MCP features skipped" in Codex degradation table
- "stripping" or "excluded" in reference to MCP tools for Gemini
  </action>
  <verify>Grep the file for contradictions: search for "Missing in:.*Gemini" (should only appear where genuinely missing, not for mcp_servers or tool_permissions), search for "N" in Gemini/Codex MCP context, search for "MCP features skipped" in Codex section</verify>
  <done>All Capability Details sections and Degraded Behavior Summary tables are internally consistent with the corrected Quick Reference table. No contradictory prose remains in the document.</done>
</task>

</tasks>

<verification>
1. Read the full capability-matrix.md and verify ALL four sections are consistent:
   - Quick Reference table
   - Capability Details (task_tool, tool_permissions, mcp_servers)
   - Degraded Behavior Summary (Codex CLI, Gemini CLI)
   - Feature Detection Convention (should need no changes)
2. Grep for contradictions: `grep -n "Missing in" capability-matrix.md` and verify each occurrence is correct
3. Verify footnote numbering [1]-[4] matches the Quick Reference table annotations
</verification>

<success_criteria>
- capability-matrix.md has 4 corrected cells with annotations [1]-[4]
- Capability Details prose for mcp_servers, tool_permissions, and task_tool all reflect updated values
- Degraded Behavior Summary tables for Codex CLI and Gemini CLI reflect corrected capabilities
- Zero contradictions between any section of the document
- Document is valid markdown (table alignment, footnotes properly formatted)
</success_criteria>

<output>
After completion, create `.planning/phases/18-capability-matrix-installer-corrections/18-01-SUMMARY.md`
</output>

---
phase: 01-knowledge-store
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/agents/knowledge-store.md
autonomous: true

must_haves:
  truths:
    - "Any GSD agent can read knowledge-store.md and know exactly how to create, read, and organize knowledge base entries"
    - "All three entry types (signal, spike, lesson) have clearly defined schemas with common base and type-specific extensions"
    - "Directory layout, naming conventions, and index format are fully specified"
  artifacts:
    - path: ".claude/agents/knowledge-store.md"
      provides: "Complete knowledge store reference specification"
      contains: "frontmatter schema, directory layout, naming conventions, templates, index format, durability classes, tag taxonomy"
  key_links:
    - from: ".claude/agents/knowledge-store.md"
      to: "~/.claude/gsd-knowledge/"
      via: "directory path specification"
      pattern: "gsd-knowledge"
---

<objective>
Define the complete Knowledge Store specification as a reference document that all GSD agents will read when interacting with the knowledge base.

Purpose: This is the foundational spec for the entire reflect system. Every downstream agent (signal collector, spike runner, reflection engine, knowledge surfacer) reads this document to know how to write and read knowledge base entries. Getting the schema, layout, and conventions right here determines the quality of all subsequent phases.

Output: A single reference document at `.claude/agents/knowledge-store.md` containing the complete specification.
</objective>

<execution_context>
@/Users/rookslog/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rookslog/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-knowledge-store/01-CONTEXT.md
@.planning/phases/01-knowledge-store/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create knowledge store reference document</name>
  <files>.claude/agents/knowledge-store.md</files>
  <action>
Create `.claude/agents/knowledge-store.md` as the authoritative reference document for the GSD knowledge store. This file is a NEW file (fork constraint: additive only).

The document must contain these sections:

**1. Overview**
- Purpose: persistent, cross-project knowledge base at `~/.claude/gsd-knowledge/`
- Consumers: GSD-internal agents only
- Philosophy: "dumb-but-well-organized filing cabinet" -- intelligence lives in agents that read from it
- Agent-first, human-readable

**2. Directory Structure**
```
~/.claude/gsd-knowledge/
├── signals/
│   └── {project-name}/
│       └── {YYYY-MM-DD}-{slug}.md
├── spikes/
│   └── {project-name}/
│       └── {spike-name}.md
├── lessons/
│   └── {category}/
│       └── {lesson-name}.md
└── index.md
```
- Project-scoped entries use project subdirectories under their type
- Global entries use `_global/` as project name
- Lessons organized by category subdirectory, not project

**3. Common Base Schema (YAML frontmatter)**
Required fields for ALL entry types:
- `id`: `{type-prefix}-{YYYY-MM-DD}-{slug}` (prefixes: `sig-`, `spk-`, `les-`)
- `type`: signal | spike | lesson
- `project`: project name or `_global`
- `tags`: array, seeded taxonomy + freeform extension
- `created`: ISO-8601 timestamp
- `updated`: ISO-8601 timestamp
- `durability`: workaround | convention | principle
- `status`: active | archived

**4. Type-Specific Extensions**

Signal extensions:
- `severity`: critical | high | medium | low
- `signal_type`: deviation | struggle | config-mismatch | custom
- `phase`: phase number (optional)
- `plan`: plan number (optional)

Spike extensions:
- `hypothesis`: string (the testable claim)
- `outcome`: confirmed | rejected | partial | inconclusive
- `rounds`: number of iteration rounds

Lesson extensions:
- `category`: architecture | workflow | tooling | testing | debugging | performance | other
- `evidence_count`: number of supporting signals/spikes
- `evidence`: array of entry IDs that support this lesson

**5. Body Templates**
Define recommended body sections for each type:
- Signal: What Happened, Context, Potential Cause
- Spike: Hypothesis, Experiment, Results, Decision, Consequences
- Lesson: Lesson, When This Applies, Recommendation, Evidence

**6. Seeded Tag Taxonomy**
Define initial tags organized by concern:
- Type-of-issue: auth, config, performance, error-handling, data, ui, testing
- Workflow: frustration, deviation, retry, workaround, blocked
- Domain: (freeform -- agents create as needed)
Note: agents may create new tags freely; seeded tags provide consistency starting points.

**7. Naming Conventions**
- Signals: `{YYYY-MM-DD}-{slug}.md` (date-prefixed for chronological sorting)
- Spikes: `{spike-name}.md` (descriptive name, no date prefix)
- Lessons: `{lesson-name}.md` (descriptive name, no date prefix)
- Slugs: kebab-case, derived from entry title, max 50 chars

**8. ID Format**
- Pattern: `{type-prefix}-{YYYY-MM-DD}-{slug}`
- Type prefixes: `sig-`, `spk-`, `les-`
- Example: `sig-2026-02-02-auth-retry-loop`
- IDs are unique across the entire knowledge store

**9. Index Format (index.md)**
- Auto-generated, never hand-edited
- Header with generation timestamp and total entry count
- Per-type sections (Signals, Spikes, Lessons) with markdown tables
- One row per entry with: ID, Project, type-key-field, Tags, Date, Status
- Signal key field: Severity; Spike key field: Outcome; Lesson key field: Category
- Files are source of truth; index is a derived cache
- Rebuild: full scan of all files, write to temp, rename (atomic)

**10. Lifecycle Rules**
- No time-based decay (per CONTEXT.md)
- No hard entry caps (per CONTEXT.md)
- No static relevance scores (per CONTEXT.md)
- Archival: set `status: archived` in frontmatter; archived entries excluded from index
- Signals and spikes are immutable after creation
- Lessons update-in-place (bump `updated` timestamp)
- Track `retrieval_count` and `last_retrieved` in frontmatter for future pruning design (optional, updated on read)

**11. Durability Classes**
- `workaround`: Fragile -- tied to external bugs/limitations, likely to become irrelevant when fixed
- `convention`: Durable -- project-specific patterns, relevant while project exists
- `principle`: Highly durable -- general wisdom applicable across projects

**12. Concurrency**
- Unique IDs prevent write collisions between parallel agents
- Index rebuild is atomic (write temp file, rename)
- No lock files needed; agents write different files

**13. Promotion Model**
- Project entry to global: change `project` field to `_global`, move file to `_global/` subdirectory
- Global entries available to all projects via index query

Do NOT include:
- Static relevance scores
- Time-based decay mechanisms
- Hard entry caps or limits
- Complex validation logic
- Runtime code (this is a specification, not executable code)
  </action>
  <verify>
- File exists at `.claude/agents/knowledge-store.md`
- File contains YAML frontmatter with `name: knowledge-store` and `description`
- File contains all 13 sections listed above
- File does NOT mention static relevance scores, time-based decay, or hard entry caps as active features
- File references `~/.claude/gsd-knowledge/` as the canonical path
- All three entry types (signal, spike, lesson) have complete schemas
- Index format section specifies per-type tables with one-row-per-entry
  </verify>
  <done>
A complete, self-contained reference document exists that any GSD agent can read to understand how to interact with the knowledge store. The document covers schema, layout, naming, indexing, lifecycle, and concurrency -- everything needed for Phases 2-5 to build on.
  </done>
</task>

</tasks>

<verification>
- `.claude/agents/knowledge-store.md` exists and is a valid Markdown file with YAML frontmatter
- All three entry types have clearly defined schemas (common base + type extensions)
- Directory structure, naming conventions, and index format are fully specified
- No references to decay, caps, or static relevance as active features
- Fork constraint respected: only new files created, no existing files modified
</verification>

<success_criteria>
Any GSD agent reading `.claude/agents/knowledge-store.md` has complete, unambiguous instructions for creating, reading, organizing, and indexing knowledge base entries of all three types.
</success_criteria>

<output>
After completion, create `.planning/phases/01-knowledge-store/01-01-SUMMARY.md`
</output>

---
phase: 27-workflow-dx-reliability
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/workflows/quick.md
autonomous: true

must_haves:
  truths:
    - "Trivial task descriptions (short, single concern, <100 chars) skip planner+executor agent spawns and execute inline"
    - "Complex task descriptions (multi-step, multiple concerns, >100 chars, or containing complexity keywords) fall back to the full planner+executor flow unchanged"
    - "Inline execution path still creates minimal PLAN.md and SUMMARY.md for STATE.md tracking consistency"
    - "Step 7 (STATE.md update) and Step 8 (commit) work identically for both inline and full execution paths"
  artifacts:
    - path: "get-shit-done/workflows/quick.md"
      provides: "Complexity gate between Step 4 and Step 5, inline execution path (Step 5a/6a)"
      contains: "isTrivial"
  key_links:
    - from: "Step 4b (complexity gate)"
      to: "Step 5 (planner spawn) OR Step 5a (inline execution)"
      via: "isTrivial boolean evaluation of $DESCRIPTION"
      pattern: "isTrivial"
    - from: "Step 5a/6a (inline execution)"
      to: "PLAN.md and SUMMARY.md"
      via: "Minimal artifact creation for tracking consistency"
      pattern: "PLAN.md|SUMMARY.md"
---

<objective>
Add a complexity detection gate to the `/gsd:quick` workflow that skips the planner+executor agent spawns for trivial tasks and executes them inline, while preserving the full flow for complex tasks.

Purpose: DX-01 and DX-02 -- trivial tasks like "fix typo in README" should not incur the overhead of spawning a planner agent and then an executor agent. The complexity gate detects trivial vs complex descriptions using simple heuristics (character length, keyword presence, structure) and routes accordingly.

Output: Updated quick.md workflow with complexity gate and inline execution path.
</objective>

<execution_context>
@/Users/rookslog/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rookslog/.claude/get-shit-done/templates/summary-standard.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/27-workflow-dx-reliability/27-RESEARCH.md
@get-shit-done/workflows/quick.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add complexity detection gate and inline execution path to quick.md</name>
  <files>get-shit-done/workflows/quick.md</files>
  <action>
    Add a new **Step 4b: Assess task complexity** between Step 4 and Step 5 in quick.md.

    The complexity gate evaluates `$DESCRIPTION` using these heuristics (ALL must be true for trivial):
    - Length < 100 characters
    - Does NOT contain multi-step indicators: "and then", "also", "additionally", "as well"
    - Does NOT contain multi-concern indicators: "multiple", "several", "across", "each", "all"
    - Does NOT contain complexity keywords: "refactor", "migrate", "integrate", "architecture", "redesign"
    - Does NOT contain numbered steps (patterns like "1." "2." or bullet lists)
    - Is a single sentence (no newlines, no semicolons separating clauses)

    If `isTrivial` is true:
    - Add **Step 5a: Execute inline (trivial task)** that:
      1. Instructs the orchestrating agent to execute the task directly (no Task() spawn)
      2. The agent reads relevant files, makes the changes, runs verification
      3. Commits changes atomically per normal GSD patterns
    - Add **Step 6a: Create minimal tracking artifacts** that:
      1. Creates `${QUICK_DIR}/${next_num}-PLAN.md` with minimal frontmatter (phase: quick, plan: ${next_num}, type: execute, wave: 1) and a single task describing the work done
      2. Creates `${QUICK_DIR}/${next_num}-SUMMARY.md` with task count, duration, commit hash, and files modified
      3. These minimal artifacts ensure STATE.md tracking (Step 7) and final commit (Step 8) work identically
    - Then continues to Step 7 (unchanged)

    If `isTrivial` is false:
    - Proceeds to existing Step 5 (planner spawn) and Step 6 (executor spawn) unchanged

    Add a note after the complexity gate explaining the conservative approach: the heuristic errs on the side of caution -- false positives (treating trivial as complex) only waste a planner spawn, but false negatives (treating complex as trivial) risk incomplete execution.

    Important: Do NOT modify Steps 1-4, Step 5, Step 6, Step 7, or Step 8 in any way. The existing full flow must remain completely intact. Only ADD the new steps (4b, 5a, 6a) and the conditional branching.

    Update the success_criteria section at the bottom to add:
    - [ ] Complexity gate evaluates task description
    - [ ] Trivial tasks execute inline (no agent spawn)
    - [ ] Complex tasks use full planner+executor flow
    - [ ] Minimal PLAN.md and SUMMARY.md created for inline tasks
  </action>
  <verify>
    Read get-shit-done/workflows/quick.md and verify:
    1. Step 4b exists with complexity heuristics
    2. Step 5a exists with inline execution instructions
    3. Step 6a exists with minimal artifact creation
    4. Steps 1-4, 5, 6, 7, 8 are unchanged
    5. Both paths converge at Step 7
  </verify>
  <done>quick.md contains a complexity gate that routes trivial tasks to inline execution and complex tasks to the existing planner+executor flow, with both paths creating tracking artifacts for STATE.md consistency</done>
</task>

<task type="auto">
  <name>Task 2: Verify workflow structure and edge case handling</name>
  <files>get-shit-done/workflows/quick.md</files>
  <action>
    Review the updated quick.md for correctness and edge cases:

    1. Verify the inline execution path (Step 5a) produces the same STATE.md table format as the full path -- the row format in Step 7c must work for both paths (commit_hash variable must be set in both paths)

    2. Verify Step 8 commit command works for both paths -- the files list (`${next_num}-PLAN.md`, `${next_num}-SUMMARY.md`, `.planning/STATE.md`) is identical regardless of path taken

    3. Check that the complexity heuristic handles edge cases documented in research:
       - "update the tests and fix the linting errors" should be complex (contains "and")
       - "fix typo in README" should be trivial
       - "update version to 1.5.0" should be trivial
       - "refactor auth module" should be complex (contains "refactor")
       - Multi-line descriptions should be complex

    4. Add a brief inline comment at the top of the complexity gate noting example trivial tasks and example complex tasks for future maintainability

    5. Ensure the completion output in Step 8 works for both paths (the display template uses `${QUICK_DIR}/${next_num}-SUMMARY.md` which exists in both paths)

    Fix any issues found. The goal is that the workflow is robust for both paths with no tracking gaps.
  </action>
  <verify>
    Read quick.md and confirm:
    1. Step 7/8 variable references ($commit_hash, $next_num, $QUICK_DIR) are set in both paths
    2. Examples of trivial and complex tasks are documented in the complexity gate
    3. The workflow converges cleanly at Step 7 for both paths
  </verify>
  <done>The quick workflow handles both trivial and complex tasks correctly with identical tracking artifacts and STATE.md updates, and includes inline documentation of the heuristic with examples</done>
</task>

</tasks>

<verification>
```bash
# Verify quick.md exists and contains the complexity gate
grep -c "isTrivial\|complexity\|trivial" get-shit-done/workflows/quick.md
# Should return 5+ matches

# Verify the workflow still has all original steps
grep -c "^\\*\\*Step [0-9]" get-shit-done/workflows/quick.md
# Should return 10+ (original 8 + new 4b, 5a, 6a)

# Verify success criteria updated
grep "Trivial tasks execute inline" get-shit-done/workflows/quick.md
```
</verification>

<success_criteria>
- quick.md has Step 4b with complexity detection heuristic
- Trivial tasks (<100 chars, single concern, no complexity keywords) route to inline execution
- Complex tasks route to existing planner+executor flow (Steps 5-6 unchanged)
- Inline path creates minimal PLAN.md and SUMMARY.md
- Both paths converge at Step 7 for STATE.md update
- Both paths produce identical STATE.md row format
- Step 8 commit works for both paths
- Examples of trivial/complex tasks documented inline
</success_criteria>

<output>
After completion, create `.planning/phases/27-workflow-dx-reliability/27-01-SUMMARY.md`
</output>

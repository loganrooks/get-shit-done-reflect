---
phase: 31-signal-schema-foundation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/references/signal-detection.md
  - get-shit-done/references/reflection-patterns.md
autonomous: true

must_haves:
  truths:
    - "signal-detection.md severity table includes four tiers (critical, notable, minor, trace) with updated rigor descriptions"
    - "signal-detection.md documents signal_category field and positive signal detection rules"
    - "signal-detection.md signal_type enum includes epistemic-gap, baseline, improvement, good-pattern"
    - "reflection-patterns.md severity-weighted thresholds use the four-tier model (critical, notable, minor, trace)"
    - "reflection-patterns.md confidence expression aligns with the three-tier model (high, medium, low) from the schema"
  artifacts:
    - path: "get-shit-done/references/signal-detection.md"
      provides: "Detection rules updated for four-tier severity, positive signals, epistemic gaps, and signal_category"
      contains: "signal_category"
    - path: "get-shit-done/references/reflection-patterns.md"
      provides: "Pattern detection rules updated for four-tier severity and lifecycle-aware confidence"
      contains: "minor"
  key_links:
    - from: "get-shit-done/references/signal-detection.md"
      to: "agents/knowledge-store.md"
      via: "Schema extensions reference the authoritative schema"
      pattern: "knowledge-store.md"
    - from: "get-shit-done/references/reflection-patterns.md"
      to: "get-shit-done/references/signal-detection.md"
      via: "Pattern detection uses severity tiers defined in detection reference"
      pattern: "critical.*notable.*minor.*trace"
---

<objective>
Update signal-detection.md and reflection-patterns.md reference documents to align with the extended signal schema -- four-tier severity, positive signal detection, epistemic gap signals, signal_category field, and lifecycle-aware confidence.

Purpose: These references are consumed by the signal-collector and reflector agents at runtime. Without updates, agents will create signals using the old two-tier severity model and miss positive/epistemic-gap signal types.

Output: Updated signal-detection.md and reflection-patterns.md that are consistent with the Phase 31 schema extensions.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary-standard.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/31-signal-schema-foundation/31-RESEARCH.md
@.planning/phases/31-signal-schema-foundation/31-CONTEXT.md
@get-shit-done/references/signal-detection.md
@get-shit-done/references/reflection-patterns.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update signal-detection.md with four-tier severity, positive signals, and epistemic gaps</name>
  <files>get-shit-done/references/signal-detection.md</files>
  <action>
Update get-shit-done/references/signal-detection.md (npm source, NOT .claude/ path).

**Section 6 (Severity Auto-Assignment) updates:**
- Expand severity enum from `critical | notable` to `critical | notable | minor | trace`
- Update the severity auto-assignment table. Keep existing rules, and add `minor` assignments:
  - `minor`: Single auto-fix, minor file differences (move from trace), task order changes with no impact
  - `trace`: Capability gap (known runtime limitation) -- keep as trace (not persisted)
- Update persistence rules to include `minor`:
  - critical: always persisted to KB
  - notable: always persisted to KB
  - minor: always persisted to KB (NEW -- previously these were trace/not persisted)
  - trace: logged in collection report only, NOT written to KB. Enforcement: The signal synthesizer (Phase 32) is the enforcement point -- it filters trace signals before KB write. Until Phase 32, the signal-collector emits all signals regardless of severity. Document this enforcement note alongside the trace persistence rule.
- Add a note about epistemic rigor requirements by severity tier (referencing knowledge-store.md Section 4.3):
  - critical: evidence.counter REQUIRED
  - notable: evidence RECOMMENDED
  - minor: evidence OPTIONAL
  - trace: not applicable (not persisted)

**Section 8 (Signal Schema Extensions) updates:**
- Add `signal_category` field to the extensions table:
  | `signal_category` | enum: positive, negative | negative | Whether the signal represents a positive or negative observation |
- Update the `signal_type` description to note extended enum values: `deviation`, `struggle`, `config-mismatch`, `capability-gap`, `epistemic-gap`, `baseline`, `improvement`, `good-pattern`, `custom`
- Add lifecycle fields to the extensions table (or add a note referencing knowledge-store.md for the full lifecycle field list):
  | `lifecycle_state` | enum: detected, triaged, remediated, verified, invalidated | detected | Current lifecycle state -- see knowledge-store.md Section 4.2 |
  | `evidence` | object: {supporting: [], counter: []} | {} | Epistemic evidence -- see knowledge-store.md Section 4.3 |
  | `confidence` | enum: high, medium, low | medium | Categorical confidence level |
  | `confidence_basis` | string | "" | Text explaining confidence assessment |

**NEW Section 2.1 or update Section 2 (Deviation Detection):**
- Add positive deviation detection subsection (expand the existing "Positive deviation detection" bullet points):
  - Positive signals use signal_category: positive and one of signal_type: baseline | improvement | good-pattern
  - Detection criteria for each type:
    - baseline: Sensor observes a normal/healthy state worth tracking as a regression guard
    - improvement: Execution outcome is measurably better than planned/expected
    - good-pattern: Practice or approach worth repeating, identified during execution
  - Positive signals follow the same lifecycle and rigor rules as negative signals (proportional to severity)

**NEW Section (after Section 12 or as Section 13): Epistemic Gap Detection.**
- signal_type: epistemic-gap
- signal_category: negative (gaps represent missing knowledge)
- confidence: inherently low (flagging what we DON'T know)
- Detection criteria: Sensor identifies a domain where evidence is insufficient, unverifiable, or indirect
- Examples: missing sensor coverage, unverifiable causal claims, indirect evidence for key conclusions

Update the version to 1.2.0 and the phase reference at the bottom.
  </action>
  <verify>
- `grep "minor" get-shit-done/references/signal-detection.md` returns severity references
- `grep "signal_category" get-shit-done/references/signal-detection.md` returns field definition
- `grep "epistemic-gap" get-shit-done/references/signal-detection.md` returns section
- `grep "baseline" get-shit-done/references/signal-detection.md` returns positive signal type
- `grep "1.2.0" get-shit-done/references/signal-detection.md` returns version update
- `grep "synthesizer" get-shit-done/references/signal-detection.md` returns trace enforcement note (Gap 7)
  </verify>
  <done>
signal-detection.md uses four-tier severity model, documents signal_category field, includes positive signal detection rules (baseline/improvement/good-pattern), defines epistemic gap detection, and documents trace non-persistence enforcement point (Phase 32 synthesizer) -- all consistent with the schema in knowledge-store.md.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update reflection-patterns.md with four-tier severity and lifecycle-aware confidence</name>
  <files>get-shit-done/references/reflection-patterns.md</files>
  <action>
Update get-shit-done/references/reflection-patterns.md (npm source, NOT .claude/ path).

**Section 2.1 (Severity-Weighted Thresholds) updates:**
- The current table uses `critical | high | medium | low` severity levels. These do NOT match the signal schema which uses `critical | notable | minor | trace`. Update to match:
  | Signal Severity | Threshold | Rationale |
  |-----------------|-----------|-----------|
  | `critical` | 2 occurrences | Cannot risk missing dangerous patterns |
  | `notable` | 3 occurrences | High-impact issues warrant attention |
  | `minor` | 5 occurrences | Must be truly recurring, not noise |
  | `trace` | N/A | Not persisted to KB, not in pattern detection pool |
- Update the pseudocode case statement to match the new severity names. IMPORTANT: The case statement MUST list `critical`, `notable`, `minor`, and `trace` as four separate, individual case entries (not combined with `|` or collapsed). This is required for key_link pattern verification which checks that all four tier names appear as distinct entries in this section:
  ```
  case "$max_severity" in
    critical) [ "$count" -ge 2 ] && emit_pattern ;;
    notable)  [ "$count" -ge 3 ] && emit_pattern ;;
    minor)    [ "$count" -ge 5 ] && emit_pattern ;;
    trace)    ;; # trace signals are not persisted, skip
  esac
  ```

**Section 9 (Confidence Expression) updates:**
- Rename confidence levels from HIGH/MEDIUM/LOW to high/medium/low (lowercase to match schema field values)
- Update the criteria table to align with the schema's three-tier model:
  | Level | Criteria | Expression |
  |-------|----------|------------|
  | `high` | 6+ occurrences, empirical evidence, consistent root cause | "high (7 occurrences across 3 projects)" |
  | `medium` | 3-5 occurrences, inference from patterns | "medium (4 occurrences, same root cause)" |
  | `low` | 2-3 occurrences, educated guess, or epistemic gap | "low (2 occurrences, similar symptoms)" |
- Update actionability table to use lowercase confidence names
- Update Section 9.3 examples to use lowercase

**Section 10.6 (Anti-pattern: Modifying Existing Signals) update:**
- Update this anti-pattern to reflect the new mutability boundary. The rule is no longer "only status field changes allowed" -- it is: "Detection payload fields are frozen; lifecycle fields (lifecycle_state, triage, remediation, verification, lifecycle_log, updated) may be modified. See knowledge-store.md Section 10."
- This is a critical change -- the old rule said signals are fully immutable (except status). The new rule says detection payload is frozen but lifecycle fields are mutable.

**Add a note in Section 2.2 (Signal Clustering Criteria):**
- Clustering should consider signal_category -- positive signals cluster separately from negative signals (a positive baseline and a negative deviation with overlapping tags should NOT cluster together)
- Epistemic gap signals may cluster with related deviation signals if tags overlap (an epistemic gap about auth and a deviation about auth are related)

Update the version to 1.1.0 and the phase reference at the bottom.
  </action>
  <verify>
- `grep "notable" get-shit-done/references/reflection-patterns.md` returns severity references (replacing "high")
- `grep "minor" get-shit-done/references/reflection-patterns.md` returns severity references (replacing "medium")
- `grep "trace" get-shit-done/references/reflection-patterns.md` returns severity references (replacing "low")
- `grep "lifecycle" get-shit-done/references/reflection-patterns.md` returns mutability update in anti-patterns
- `grep "signal_category" get-shit-done/references/reflection-patterns.md` returns clustering note
- `grep "1.1.0" get-shit-done/references/reflection-patterns.md` returns version update
  </verify>
  <done>
reflection-patterns.md uses four-tier severity model matching the signal schema (critical/notable/minor/trace), confidence expression uses lowercase three-tier model (high/medium/low), anti-pattern section reflects the new mutability boundary, and clustering considers signal_category.
  </done>
</task>

</tasks>

<verification>
- [ ] signal-detection.md severity enum includes all four tiers: critical, notable, minor, trace
- [ ] signal-detection.md documents signal_category and positive signal detection
- [ ] signal-detection.md includes epistemic gap detection section
- [ ] signal-detection.md documents trace non-persistence enforcement point (Phase 32 synthesizer)
- [ ] reflection-patterns.md severity thresholds use signal schema names (not high/medium/low)
- [ ] reflection-patterns.md confidence uses lowercase (high/medium/low) matching schema
- [ ] reflection-patterns.md anti-pattern 10.6 reflects lifecycle mutability boundary
- [ ] Both files have updated version numbers
- [ ] No files edited in .claude/ directory
</verification>

<success_criteria>
Signal detection and reflection pattern references are fully consistent with the Phase 31 extended signal schema. The signal-collector and reflector agents will produce signals that conform to the four-tier severity model, include signal_category, and handle epistemic gaps and positive signals correctly.
</success_criteria>

<output>
After completion, create `.planning/phases/31-signal-schema-foundation/31-02-SUMMARY.md`
</output>

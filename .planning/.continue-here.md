# Continue Here: Recover Lost Code from Deleted Local Patches

**Paused:** 2026-02-26T08:36:13.128Z
**Context:** Released v1.15.2. Need to recover code that was lost when "local patches" were deleted in a previous session. The patches were dismissed as false positives from dogfooding, but they contained real development work that was only in .claude/ (installed copies) and never synced to npm source dirs.

<current_state>
v1.15.2 released with dual-install detection (quick-7) and the source directory sync fix. The agent protocol and KB surfacing content is now properly synced between .claude/ and agents/get-shit-done/ npm source dirs. CLAUDE.md created with project rules. Deliberations recovered and saved.

Still outstanding: there was a session where "local patches" were cleaned up (dismissed as false positive). That cleanup likely deleted code changes in .claude/ that represented real development work. Need to find that commit, understand what was lost, and restore it properly to the npm SOURCE directories (not .claude/).
</current_state>

<completed_work>

- Quick task 7: dual-install detection (3 tasks, 4 commits)
- Source sync fix: agent-protocol.md + 14 agent specs + dual-installation.md + run-spike.md synced from .claude/ to npm source dirs (commit 2865099)
- CLAUDE.md created with dual-directory architecture rules (commit a9ae42d)
- Deliberations recovered: v1.16 brainstorming (251 lines) from git history + this session's design discussion saved to .planning/deliberations/
- Released v1.15.2 (tag reflect-v1.15.2, GitHub Release created)
</completed_work>

<remaining_work>

1. Find the commit where "local patches" were deleted/cleaned up
   - Signal reference: sig-2026-02-24-local-patches-false-positive-dogfooding
   - The STATE.md from the v1.16 deliberations mentions: "Local patches cleaned up (false positive from dogfooding)"
   - Search git log for commits around 2026-02-24 mentioning patches/cleanup/restore
2. Examine what was in the deleted patches — diff the commit to understand what code was removed
3. Determine which removed code represents genuine development vs actual installer artifacts
4. Restore the genuine development work to the npm SOURCE directories (agents/, get-shit-done/, commands/) — NOT to .claude/
5. Run tests to verify
6. Commit and potentially release as v1.15.3

Also discussed but deferred to later milestones:
- Codebase docs (.planning/codebase/) are 23 days stale — need maintenance mechanism
- Living project model design (current state + history + future + rules)
- Deliberation system (more than just a directory)
- Convention extraction and improvement recommendations during init
- Packaging verification test (source/install parity)
</remaining_work>

<decisions_made>

- Dual-directory architecture rule formalized in CLAUDE.md: always edit npm source dirs (agents/, get-shit-done/), never .claude/ directly
- .planning/deliberations/ created as persistent storage for rich design thinking (interim solution — proper system to be designed later)
- CLAUDE.md force-tracked despite .gitignore (upstream had it ignored)
- Source sync uses sed path conversion: ./.claude/ → ~/.claude/ when copying from install target to npm source
</decisions_made>

<blockers>
None. Clean working tree, tests passing, release complete.
</blockers>

<context>
This session uncovered a systemic development workflow bug: v1.15 Phase 22 (agent protocol extraction) and likely other phases developed exclusively in .claude/ (the install target) instead of npm source directories. The installer then overwrote that work. We fixed it for the known cases, but there may be additional lost work from when "local patches" were cleaned up in a previous session. The user also raised important broader questions about codebase doc maintenance, deliberation storage, living project model, and prevention mechanisms — all captured in .planning/deliberations/development-workflow-gaps.md.
</context>

<next_action>
Find and recover the code lost when local patches were deleted. Start by searching git log around 2026-02-24 for the cleanup commit, examine the diff, restore genuine work to npm source directories (not .claude/). After recovery, assess whether a v1.15.3 patch is needed.
</next_action>
